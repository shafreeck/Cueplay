# Cueplay 后续开发功能规划 (Future Development Plan)

本文档基于当前 v0.2.0 版本的完成情况，对 Cueplay 的后续开发功能进行优先级排序与详细规划。

## 优先级说明
- **P0**: 核心体验完善与多端发布（当前阶段重点）
- **P1**: 资源生态与播放增强（功能性护城河）
- **P2**: 社交互动与安全性（体验升华）
- **P3**: 生态插件与 AI 赋能（前瞻探索）

---

## P0 级：核心体验完善与多端发布
这些功能决定了应用的基础可用性和用户留存，是目前最迫切需要完成的。

### 1. 移动端深度适配 (iOS/Android)
- **手势操作**：支持移动端标准的播放器手势：
  - 左侧上下滑动：调节亮度
  - 右侧上下滑动：调节音量
  - 水平滑动：快进/快退
  - 长按触发：倍速播放
- **画中画 (PiP)**：支持系统级原生画中画功能，允许用户切出应用后继续观看。
- **UI 布局优化**：全面适配刘海屏、圆角屏及灵动岛，优化资源库在小屏幕上的交互（如左右滑动菜单）。

### 2. 同步机制的健壮性 (Network Resilience)
- **弱网预测补偿**：引入“预测对齐”算法。针对高延迟或抖动严重的网络环境，通过动态调整 `playbackRate` 进行静默修正，极大程度减少 Hard Seek（跳回重播）导致的画面撕裂感。

### 3. 代码重构与架构升级
- **逻辑解耦**：将 `room/page.tsx` 中庞大的业务逻辑分流至自定义 Hooks（如 `useSync`, `useChat`, `usePlaylist`）。
- **状态管理转向 Zustand**：用 Zustand 替代部分复杂的 React 原生状态，解决跨组件状态传递时的性能瓶颈及冗余渲染。

---

## P1 级：资源生态与播放增强
增强应用作为“万能协作播放器”的属性，打破单一存储源限制。

### 1. 增强型字幕系统 (Subtitle Pro)
- **外部字幕加载**：支持用户直接拖入或上传 `.srt`, `.ass`, `.vtt` 等外部字幕文件。
- **在线自动匹配**：集成开源字幕库接口，根据视频文件名自动搜索、下载并匹配字幕。
- **字幕同步微调**：在控制界面增加字幕偏移（Offset）调整功能。

### 2. 多存储源扩展
- **WebDAV/NAS 挂载**：打通阿里云盘（通过 AList）、群晖 NAS 等私有存储协议。
- **局域网流化 (Edge Casting)**：支持房主将本地视频文件通过 WebRTC P2P 实时推送至房间内其他团员，无需预先上传云端。

### 3. 高级播放控制
- **音轨切换**：支持内封或外挂多音轨的选择与切换。
- **画面后期调节**：内置简单的视频滤镜（亮度、对比度、锐化）及比例拉伸。

---

## P2 级：社交互动与安全性
让“一起看”的过程更有社交温度，同时保障房间私密性。

### 1. 实时通讯增强 (Social)
- **多人语音连麦**：集成 WebRTC 多人语音，支持在同步观看过程中实时语音交流，降低沟通延迟。
- **关键剧情互动**：支持在视频进度条上打点并发送对应时间的表情弹幕。

### 2. 房间安全管理
- **访问控制**：支持设置房间进入密码。
- **权限管理系统**：房主可以限制成员的操作权限（如：禁止普通成员切换剧集、禁止调节同步速率）。

### 3. 全端云同步
- **账户云端足迹**：观看记录、收藏夹及个性化播放设置在 iOS/Android/PC 三端自动同步。

---

## P3 级：生态插件与 AI 赋能

### 1. 插件架构
- **开放 Provider API**：允许第三方开发者自行开发新的网盘驱动或视频源解析插件。

### 2. AI 赋能
- **AI 智能翻译**：利用边缘计算或 API 实现字幕的即时翻译。
- **剧情搜索与摘要**：通过 AI 自动分析剧情，支持“跳过片头/片尾”的智能识别。

---

## 当前路线图建议 (Actionable Next Steps)

1. **第一阶段：** 优先进行代码级重构，将 `room` 页面核心逻辑拆离。
2. **第二阶段：** 集中实现移动端手势操作及外部字幕挂载。
3. **第三阶段：** 正式发布 iOS/Android 稳定版，并开启 WebDAV 支持测试。
